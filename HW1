

###################################################
## HW1 Problem 1
####################################################

#Part A
# %%
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
from pint import UnitRegistry
import scipy.integrate as spi


alt = np.linspace(-5000, 80000, 86)

temp_values = np.array([
                        320.6755834,
                        314.1663708,
                        307.6592071,
                        301.1540914,
                        294.6510227,
                        288.15,
                        281.6510224,
                        275.1540888,
                        268.6591985,
                        262.1663502,
                        255.6755432,
                        249.1867765,
                        242.700049,
                        236.2153598,
                        229.732708,
                        223.2520926,
                        216.7735127,
                        216.65,
                        216.65,
                        216.65,
                        216.65,
                        216.65,
                        216.65,
                        216.65,
                        216.65,
                        216.65,
                        217.5808535,
                        218.5741233,
                        219.5670816,
                        220.5597287,
                        221.5520647,
                        222.5440898,
                        223.5358041,
                        224.5272077,
                        225.5183008,
                        226.5090836,
                        227.4995562,
                        228.4897187,
                        230.9727994,
                        233.7435192,
                        236.5133721,
                        239.2823584,
                        242.0504785,
                        244.8177329,
                        247.584122,
                        250.3496461,
                        253.1143057,
                        255.8781012,
                        258.6410329,
                        261.4031014,
                        264.1643069,
                        266.9246499,
                        269.6841309,
                        270.65,
                        270.65,
                        270.65,
                        270.65,
                        269.0313819,
                        266.2770651,
                        263.5236076,
                        260.7710089,
                        258.0192687,
                        255.2683866,
                        252.5183622,
                        249.7691951,
                        247.0208848,
                        244.273431,
                        241.5268332,
                        238.7810911,
                        236.0362043,
                        233.2921724,
                        230.5489949,
                        227.8066715,
                        225.0652018,
                        222.3245853,
                        219.5848218,
                        216.8459107,
                        214.2627512,
                        212.3076031,
                        210.3530631,
                        208.3991308,
                        206.445806,
                        204.4930885,
                        202.5409779,
                        200.5894739,
                        198.6385763
                        ])


def standardAtmosphereTemperature(altitude):
    altitude = np.asarray(altitude)
    if altitude < -5000 or altitude > 80000:
        raise ValueError('Altitude is out of range. Must be between -5000 m and 80000 m.')
    
    temperature = np.interp(altitude, alt, temp_values)#
    return  temperature
desired_altitude = 76000
computed_temperature = standardAtmosphereTemperature(desired_altitude)
print("The temperature at", desired_altitude, "m is", computed_temperature, "K")


##Part B

plt.plot(alt, temp_values)
plt.title('Temperature vs Altitude')
plt.xlabel('Altitude (m)')
plt.ylabel('Temperature (K)')
plt.grid()
plt.savefig("temperature_vs_altitude.png")#
# %%
#Part C
def standardAtmosphere(measurement, altitude):
    if altitude < -5000 or altitude > -1000:
        raise ValueError('Altitude is out of range. Must be between -5000 m and 80000 m.')
    standardAtmosphereDictionary = {}
    standardAtmosphereDictionary['temperature']            = np.array([
        320.6755834,
        314.1663708,
        307.6592071,
        301.1540914,
        294.6510227,
        288.15,
        281.6510224,
        275.1540888,
        268.6591985,
        262.1663502,
        255.6755432,
        249.1867765,
        242.700049,
        236.2153598,
        229.732708,
        223.2520926,
        216.7735127,
        216.65,
        216.65,
        216.65,
        216.65,
        216.65,
        216.65,
        216.65,
        216.65,
        216.65,
        217.5808535,
        218.5741233,
        219.5670816,
        220.5597287,
        221.5520647,
        222.5440898,
        223.5358041,
        224.5272077,
        225.5183008,
        226.5090836,
        227.4995562,
        228.4897187,
        230.9727994,
        233.7435192,
        236.5133721,
        239.2823584,
        242.0504785,
        244.8177329,
        247.584122,
        250.3496461,
        253.1143057,
        255.8781012,
        258.6410329,
        261.4031014,
        264.1643069,
        266.9246499,
        269.6841309,
        270.65,
        270.65,
        270.65,
        270.65,
        269.0313819,
        266.2770651,
        263.5236076,
        260.7710089,
        258.0192687,
        255.2683866,
        252.5183622,
        249.7691951,
        247.0208848,
        244.273431,
        241.5268332,
        238.7810911,
        236.0362043,
        233.2921724,
        230.5489949,
        227.8066715,
        225.0652018,
        222.3245853,
        219.5848218,
        216.8459107,
        214.2627512,
        212.3076031,
        210.3530631,
        208.3991308,
        206.445806,
        204.4930885,
        202.5409779,
        200.5894739,
        198.6385763                                                            
])
    standardAtmosphereDictionary['pressure']               = np.array([
   177761.5251,
159598.1524,
142972.6856,
127782.8214,
113931.1415,
101325,
89876.2776,
79501.41107,
70121.14407,
61660.42257,
54048.26224,
47217.6171,
41105.24963,
35651.60212,
30800.66944,
26499.87312,
22699.93684,
19399.39154,
16579.57494,
14170.33411,
12111.78613,
10352.79684,
8849.700519,
7565.207272,
6467.470451,
5529.290778,
4728.925679,
4047.485361,
3466.853763,
2971.735396,
2549.212928,
2188.368591,
1879.967254,
1616.190887,
1390.415899,
1197.026277,
1031.256629,
889.0602479,
767.3052481,
663.4093415,
574.5912625,
498.5198387,
433.245908,
377.1362622,
328.819597,
287.1421821,
251.1314208,
219.9658266,
192.9502343,
169.495287,
149.1004284,
131.3397698,
115.8503243,
102.2953464,
90.33653112,
79.7788547,
70.45779241,
62.21430391,
54.87330289,
48.3372851,
42.52480478,
37.36195494,
32.78173547,
28.72346867,
25.13225891,
21.95849371,
19.15738321,
16.6885356,
14.51556597,
12.60573626,
10.92962416,
9.460818881,
8.175641886,
7.052890829,
6.073604913,
5.220850154,
4.479523059,
3.836219321,
3.280192446,
2.800834879,
2.388123693,
2.033273453,
1.728592549,
1.467355126,
1.243687049,
1.05246447

])
    standardAtmosphereDictionary['density']                = np.array([
1.931123197,
1.769726975,
1.61890463,
1.478161245,
1.347015529,
1.225000018,
1.111659674,
1.006553754,
0.909254345,
0.819346599,
0.736428613,
0.66011132,
0.590018369,
0.525786007,
0.467062963,
0.41351033,
0.364801437,
0.311937453,
0.266595494,
0.227855493,
0.194754547,
0.166470431,
0.142301012,
0.121646676,
0.103995337,
0.088909638,
0.07571465,
0.064509644,
0.055005536,
0.046937724,
0.040083757,
0.034256463,
0.029298224,
0.025076203,
0.021478356,
0.018410101,
0.015791534,
0.013555097,
0.011572986,
0.009887355,
0.008463333,
0.007257881,
0.006235433,
0.00536653,
0.004626718,
0.003995656,
0.003456388,
0.002994747,
0.002598879,
0.002258838,
0.001966269,
0.001714138,
0.001496511,
0.001316697,
0.001162769,
0.001026876,
0.000906899,
0.000805611,
0.000717902,
0.000639,
0.000568095,
0.000504447,
0.000447376,
0.000396262,
0.000350534,
0.000309676,
0.000273211,
0.000240708,
0.000211774,
0.000186049,
0.000163209,
0.000142956,
0.000125024,
0.000109168,
9.52E-05,
8.28E-05,
7.20E-05,
6.24E-05,
5.38E-05,
4.64E-05,
3.99E-05,
3.43E-05,
2.94E-05,
2.52E-05,
2.16E-05,
1.85E-05

])
    standardAtmosphereDictionary['dynamic_viscosity']      = np.array([
1.94E-05,
1.91E-05,
1.88E-05,
1.85E-05,
1.82E-05,
1.79E-05,
1.76E-05,
1.73E-05,
1.69E-05,
1.66E-05,
1.63E-05,
1.59E-05,
1.56E-05,
1.53E-05,
1.49E-05,
1.46E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.42E-05,
1.43E-05,
1.43E-05,
1.44E-05,
1.44E-05,
1.45E-05,
1.45E-05,
1.46E-05,
1.46E-05,
1.47E-05,
1.48E-05,
1.48E-05,
1.49E-05,
1.50E-05,
1.51E-05,
1.53E-05,
1.54E-05,
1.56E-05,
1.57E-05,
1.59E-05,
1.60E-05,
1.62E-05,
1.63E-05,
1.64E-05,
1.66E-05,
1.67E-05,
1.69E-05,
1.70E-05,
1.70E-05,
1.70E-05,
1.70E-05,
1.70E-05,
1.70E-05,
1.68E-05,
1.67E-05,
1.65E-05,
1.64E-05,
1.63E-05,
1.61E-05,
1.60E-05,
1.58E-05,
1.57E-05,
1.56E-05,
1.54E-05,
1.53E-05,
1.51E-05,
1.50E-05,
1.48E-05,
1.47E-05,
1.45E-05,
1.44E-05,
1.42E-05,
1.41E-05,
1.40E-05,
1.39E-05,
1.38E-05,
1.36E-05,
1.35E-05,
1.34E-05,
1.33E-05,
1.32E-05

                                                                    ])
    standardAtmosphereDictionary['kinematic_viscosity']    = np.array([
1.01E-05,
1.08E-05,
1.16E-05,
1.25E-05,
1.35E-05,
1.46E-05,
1.58E-05,
1.71E-05,
1.86E-05,
2.03E-05,
2.21E-05,
2.42E-05,
2.65E-05,
2.90E-05,
3.20E-05,
3.53E-05,
3.90E-05,
4.56E-05,
5.33E-05,
6.24E-05,
7.30E-05,
8.54E-05,
9.99E-05,
0.000116864,
0.0001367,
0.000159894,
0.000188434,
0.000222008,
0.000261355,
0.000307432,
0.000361349,
0.000424393,
0.000498051,
0.000584048,
0.000684377,
0.00080134,
0.000937597,
0.001096217,
0.001295461,
0.001531254,
0.001806253,
0.002126375,
0.002498341,
0.002929771,
0.003429296,
0.004006674,
0.004672923,
0.005440465,
0.006323289,
0.00733712,
0.008499619,
0.009830592,
0.011352223,
0.012939028,
0.014651906,
0.016590892,
0.018785748,
0.021047634,
0.02342737,
0.026103762,
0.029117314,
0.032514557,
0.036349015,
0.040682347,
0.045585688,
0.051141225,
0.057444064,
0.064604426,
0.072750261,
0.082030335,
0.092617908,
0.104715111,
0.118558169,
0.134423643,
0.152635908,
0.173576137,
0.197693097,
0.225813664,
0.259671785,
0.298973847,
0.344655513,
0.397823859,
0.459790758,
0.532113166,
0.616641805,
0.715580116

                                                                    ])
    standardAtmosphereDictionary['speed_of_sound']         = np.array([
358.9863301,
355.3242206,
351.6251438,
347.8879198,
344.1113052,
340.293988,
336.4345821,
332.5316214,
328.5835534,
324.5887314,
320.5454069,
316.45172,
312.3056898,
308.1052024,
303.8479989,
299.5316603,
295.1535915,
295.0694935,
295.0694935,
295.0694935,
295.0694935,
295.0694935,
295.0694935,
295.0694935,
295.0694935,
295.0694935,
295.7027086,
296.3768904,
297.0493314,
297.7200436,
298.3890388,
299.0563284,
299.721924,
300.3858371,
301.0480787,
301.70866,
302.3675921,
303.0248856,
304.6669771,
306.4889023,
308.2994959,
310.0989565,
311.8874771,
313.6652451,
315.4324427,
317.1892466,
318.935829,
320.6723571,
322.3989937,
324.115897,
325.8232211,
327.5211162,
329.2097284,
329.798731,
329.798731,
329.798731,
329.798731,
328.811074,
327.1235761,
325.4278584,
323.7237914,
322.0112424,
320.2900751,
318.5601495,
316.8213219,
315.0734446,
313.316366,
311.5499301,
309.7739765,
307.9883404,
306.1928521,
304.387337,
302.5716153,
300.745502,
298.9088062,
297.0613314,
295.202875,
293.4393169,
292.0974315,
290.7497733,
289.3962613,
288.0368129,
286.6713434,
285.2997662,
283.9219925,
282.5379316
                                                                 ])
    assert(measurement in standardAtmosphereDictionary.keys())
    #raise NotImplementedError('Your code should continue here!')
    measurement_at_altitude = np.interp(altitude, alt, standardAtmosphereDictionary[measurement])   #
    return measurement_at_altitude
desired_altitude = -3215
computed_temperature = standardAtmosphere('temperature' , desired_altitude)
computed_pressure = standardAtmosphere('pressure' , desired_altitude)
computed_density = standardAtmosphere('density' , desired_altitude)
computed_speed_of_sound = standardAtmosphere('speed_of_sound' , desired_altitude)
computed_dynamic_viscosity = standardAtmosphere('dynamic_viscosity' , desired_altitude)
computed_kinematic_viscosity = standardAtmosphere('kinematic_viscosity' , desired_altitude)#

# %%
#Part D

import numpy as np
import pandas as pd

def standardAtmosphere(measurement, altitude):
    if altitude < -5000 or altitude > 80000:
        raise ValueError('Altitude is out of range. Must be between -5000 m and 80000 m.')
    
    standardAtmosphereDataframe = pd.read_csv('standard_atmosphere.csv')
    # Check existence of measurement (requires new method)
    if measurement not in standardAtmosphereDataframe.columns:
        raise ValueError('Measurement is not in the standard atmosphere data.')
    #raise NotImplementedError('Your code should continue here!')
    temperature         = standardAtmosphereDataframe['temperature [K]']
    pressure            = standardAtmosphereDataframe['pressure [N/m^2]']
    density             = standardAtmosphereDataframe['density [kg/m^3]']
    dynamic_viscosity   = standardAtmosphereDataframe['dynamic_viscosity [N*s/m^2]']
    kinematic_viscosity = standardAtmosphereDataframe['kinematic_viscosity [m^2/s]']
    speed_of_sound      = standardAtmosphereDataframe['speed_of_sound [m/s]']#
    measurement_at_altitude = np.interp(altitude, standardAtmosphereDataframe['height [m]'], standardAtmosphereDataframe[measurement])#
    return measurement_at_altitude#
# compute the properties
desired_altitude = 78888
computed_temperature         = standardAtmosphere('temperature [K]' ,         desired_altitude)
computed_pressure            = standardAtmosphere('pressure [N/m^2]' ,            desired_altitude)
computed_density             = standardAtmosphere('density [kg/m^3]' ,             desired_altitude)
computed_speed_of_sound      = standardAtmosphere('speed_of_sound [m/s]' ,      desired_altitude)
computed_dynamic_viscosity   = standardAtmosphere('dynamic_viscosity [N*s/m^2]' ,   desired_altitude)
computed_kinematic_viscosity = standardAtmosphere('kinematic_viscosity [m^2/s]' , desired_altitude)#
# Print the values
print(computed_temperature)
print(computed_pressure)
print(computed_density)
print(computed_speed_of_sound)
print(computed_dynamic_viscosity)
print(computed_kinematic_viscosity)#
# %%

#Part E
import numpy as np
import pandas as pd

def standardAtmosphere(measurement, altitude):
    if np.any(altitude < -5000) or np.any(altitude > 80000):
        raise ValueError('Altitude is out of range. Must be between -5000 m and 80000 m.')
    standardAtmosphereDictionary = pd.read_csv('standard_atmosphere.csv')
    #raise NotImplementedError('Your code should continue here!')
    temperature         = standardAtmosphereDictionary['temperature [K]']
    pressure            = standardAtmosphereDictionary['pressure [N/m^2]']
    density             = standardAtmosphereDictionary['density [kg/m^3]']
    dynamic_viscosity   = standardAtmosphereDictionary['dynamic_viscosity [N*s/m^2]']
    kinematic_viscosity = standardAtmosphereDictionary['kinematic_viscosity [m^2/s]']
    speed_of_sound      = standardAtmosphereDictionary['speed_of_sound [m/s]']#
    measurement_at_altitude = np.interp(altitude, standardAtmosphereDictionary['height [m]'], standardAtmosphereDictionary[measurement])
    return measurement_at_altitude#
# Set the desired altitude array
desired_altitude = np.array([ 1 , 1001 , 2001 , 3001 ])
alength = len(desired_altitude)#
# compute the properties
computed_temperature = standardAtmosphere('temperature [K]' , desired_altitude)
computed_pressure = standardAtmosphere('pressure [N/m^2]' , desired_altitude)
computed_density = standardAtmosphere('density [kg/m^3]' , desired_altitude)
computed_speed_of_sound = standardAtmosphere('speed_of_sound [m/s]' , desired_altitude)
computed_dynamic_viscosity = standardAtmosphere('dynamic_viscosity [N*s/m^2]' , desired_altitude)
computed_kinematic_viscosity = standardAtmosphere('kinematic_viscosity [m^2/s]' , desired_altitude)#
# Print the values
print(computed_temperature)
print(computed_pressure)
print(computed_density)
print(computed_speed_of_sound)
print(computed_dynamic_viscosity)
print(computed_kinematic_viscosity)#
# Check the lengths of the returned arrays
assert( len( computed_temperature )         == alength )
assert( len( computed_pressure )            == alength )
assert( len( computed_density )             == alength )
assert( len( computed_speed_of_sound )      == alength )
assert( len( computed_dynamic_viscosity )   == alength )
assert( len( computed_kinematic_viscosity ) == alength )#
# %%

#Part F
import numpy as np
import pandas as pd
from pint import UnitRegistry

units = UnitRegistry()#
def standardAtmosphere(measurement, altitude):
    if np.any(altitude < -5000 ) or np.any(altitude > 80000 ):
        raise ValueError('Altitude is out of range. Must be between -5000 m and 80000 m.')
    standardAtmosphereDictionary = pd.read_csv('standard_atmosphere.csv')
    #raise NotImplementedError('Your code should continue here!')
    temperature         = standardAtmosphereDictionary['temperature [K]']
    pressure            = standardAtmosphereDictionary['pressure [N/m^2]']
    density             = standardAtmosphereDictionary['density [kg/m^3]']
    dynamic_viscosity   = standardAtmosphereDictionary['dynamic_viscosity [N*s/m^2]']
    kinematic_viscosity = standardAtmosphereDictionary['kinematic_viscosity [m^2/s]']
    speed_of_sound      = standardAtmosphereDictionary['speed_of_sound [m/s]']#
    measurement_at_altitude = np.interp(altitude, standardAtmosphereDictionary['height [m]'], standardAtmosphereDictionary[measurement])
    return measurement_at_altitude    
    
# Set the desired altitude array
desired_altitude = np.array([ 1 , 1001 , 2001 , 3001 ])
# compute the properties
computed_temperature = standardAtmosphere('temperature [K]' , desired_altitude) * units.K
computed_pressure = standardAtmosphere('pressure [N/m^2]' , desired_altitude) * units.Pa
computed_density = standardAtmosphere('density [kg/m^3]' , desired_altitude) * units.kg / units.m**3
computed_speed_of_sound = standardAtmosphere('speed_of_sound [m/s]' , desired_altitude) * units.m / units.s
computed_dynamic_viscosity = standardAtmosphere('dynamic_viscosity [N*s/m^2]' , desired_altitude) * units.Pa * units.s
computed_kinematic_viscosity = standardAtmosphere('kinematic_viscosity [m^2/s]' , desired_altitude) * units.m**2 / units.s#
# Print the values
print(computed_temperature) 
print(computed_pressure)
print(computed_density)
print(computed_speed_of_sound)
print(computed_dynamic_viscosity)
print(computed_kinematic_viscosity)#
# Check the units on the values
assert(computed_temperature.check('[temperature]'))
assert(computed_pressure.check('[pressure]'))
assert(computed_density.check('[mass]/[length]^3'))
assert(computed_speed_of_sound.check('[length]/[time]'))
assert(computed_dynamic_viscosity.check('[force]*[time]/[length]^2'))
assert(computed_kinematic_viscosity.check('[length]^2/[time]'))#
# Check the lengths of the returned arrays
assert( len( computed_temperature ) == 4 )
assert( len( computed_pressure ) == 4 )
assert( len( computed_density ) == 4 )
assert( len( computed_speed_of_sound ) == 4 )
assert( len( computed_dynamic_viscosity ) == 4 )
assert( len( computed_kinematic_viscosity ) == 4 )#

#%%
#################################################
## Problem 2
#################################################
import matplotlib.pyplot as plt
import numpy as np
from pint import UnitRegistry
from scipy.integrate import solve_ivp

m = 1
L = 1 
b = 0.5
theta1 = np.deg2rad(45)
omega1 = 0  
g =9.81

y0 = [theta1, omega1]


t0, tf = 0.0, 10.0
tstep = 0.025
t_eval = np.arange(t0, tf, tstep)

def ode(t, y):
    
    theta, omega = y
    dtheta = omega
    domega = -(g/L) * np.sin(theta) - (b/(m*L**2)) * omega
    return [dtheta, domega]


sol = solve_ivp(ode, (t0, tf), [theta1, omega1], t_eval=t_eval)

theta = sol.y[0]
omega = sol.y[1]

plt.plot(sol.t, theta)
plt.title('Angular position vs Time')
plt.xlabel('Time (s)')
plt.ylabel('Angular position (rad)')
plt.grid()
plt.savefig("angular_position_vs_time.png")
print("heres theta")
print(theta[-1])

plt.figure()
plt.plot(sol.t, omega)
plt.title('Angular Velocity vs Time')
plt.xlabel('Time (s)')
plt.ylabel('Angular Velocity (rad/s)')
plt.grid()
plt.savefig("angular_velocity_vs_time.png")


dtstep = np.array([ 0.2, 0.1, 0.05, 0.02, 0.01, 0.005])
theta_final = []

for dt in dtstep:
    # make t_eval end EXACTLY at tf
    N = int(round((tf - t0)/dt)) + 1
    t_eval = np.linspace(t0, tf, N)

    sol = solve_ivp(
        ode,
        (t0, tf),                 # <-- must be a tuple
        [theta1, omega1],
        t_eval=t_eval,
        max_step=dt               # <-- makes dt actually matter
    )

    theta_final.append(sol.y[0, -1])

theta_final = np.array(theta_final)

plt.figure()
plt.plot(dtstep, np.rad2deg(theta_final), "o-")
plt.gca().invert_xaxis()
plt.xlabel("Time step Δt (s)")
plt.ylabel("Final angle θ(tf) (deg)")
plt.title("Δt vs Final Angle")
plt.grid(True)
plt.show()



# %%

#################################################
## Problem 3
#################################################
import numpy as np
import scipy as sp
import matplotlib.pyplot as plt

#part A
A = np.array([[-3, 1], [1, 1]])
B = np.array([2,5])

x = np.linalg.solve(A, B)
print("The solution to the system of equations is:")
print(x)

#part B
y = 5 -x 
fx = -4*x + 3  

def residual(vals):
    x = vals[0]
    
    res = -4*x + 3
    return res
x_guess = 0.0
solver_output = sp.optimize.root(residual, x_guess)
print(solver_output['message'])
print(solver_output['x'])

#part C

def residual(vals):
    x = vals[0]
    y = vals[1]
    r_1 = -3*x + y - 2
    r_2 = x + y - 5
    return [r_1, r_2]

x_guess = np.array([0.0, 0.0])
solver_output = sp.optimize.root(residual, x_guess, method="hybr")
print(solver_output['message'])
print(solver_output['x'])

#part D



def residual(vals):
    x = vals[0]
    y = vals[1]
    r_1 = (1 - x**2) - y
    r_2 = np.sin(x) + x**5 - y**3
    return [r_1, r_2]

x_guess = np.array([0.5, 0.8])
solver_output = sp.optimize.root(residual, x_guess, method="hybr")
print(solver_output['message'])
print(solver_output['x'])

x = np.linspace(0, 2, 100)
f1 = (1 - x**2)
f2 = np.cbrt(np.sin(x) + x**5)   
plt.plot(x, f1, label='f1')
plt.plot(x, f2, label='f2')
plt.xlabel('x')
plt.ylabel('y')
plt.title('f1 and f2 vs x')
plt.legend()
plt.grid()
plt.savefig("f1_f2_vs_x.png")
# %%
#################################################
## Problem 4
#################################################
import numpy as np
import matplotlib.pyplot as plt
import scipy as sp

#part A
def rosenbrock(ipts):
    x = ipts[0]
    y = ipts[1]
    val = (1-x)**2 + 100*(y-x**2)**2
    return val
x = 1
y = 5
computed_value = rosenbrock([x,y])
print("The value of the Rosenbrock function at (", x, ",", y, ") is:", computed_value)

#part B
x = np.linspace(-5, 5, 100)
y = np.linspace(-5, 5, 100)
X, Y = np.meshgrid(x, y)
Z = rosenbrock([X, Y])
plt.contourf(X, Y, Z, levels=50, cmap='viridis')
plt.colorbar(label='Rosenbrock Function Value')
plt.xlabel('x')
plt.ylabel('y')
plt.title('Rosenbrock Function Contour Plot')


x0 = [2, -3]
min = sp.optimize.minimize(rosenbrock, x0, method='BFGS')
print( min)

plt.plot(x0[0], x0[1], "o", label="start")
plt.plot(min.x[0], min.x[1], "x", label="solution")
plt.legend()
plt.grid()
plt.savefig("rosenbrock_contour_plot.png")


# %%
